<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tracery Story Generator</title>
  <link rel="stylesheet" href="style.css">
  <!-- Load p5 and Tracery -->
  <script src="p5.min.js"></script>
  <script src="tracery.min.js"></script>
</head>
<body>
  <h1>Generated Science Fiction Story</h1>
  
  <script>
    let grammarData, traceryGrammar, originText;
    let yPos = 0; // Vertical position of the text

    // p5 preload() loads external assets before setup()
    function preload() {
      // Load the grammar JSON file from local disk
      grammarData = loadJSON('grammar.json');
    }
    
    function setup() {
      // Create a full-window canvas
      createCanvas(windowWidth, windowHeight);
      background(0);
      fill('lime');        // Neon green fill for text
      textSize(32);
      textAlign(CENTER, CENTER);
      
      // Create the tracery grammar from the loaded JSON
      traceryGrammar = tracery.createGrammar(grammarData);
      // Flatten the origin production to generate text
      originText = traceryGrammar.flatten("#origin#");
      yPos = 0; // Start at the top of the canvas
    }
    
    function draw() {
      background(0);
      // Draw the generated text at the current vertical position
      text(originText, width / 2, yPos);
      // Increase yPos so the text falls
      yPos += 1;
      // Reset to the top if text has reached below the canvas
      if (yPos > height) {
        yPos = 0;
      }
    }
    
    // Optional: Adjust canvas size on window resize
    function windowResized() {
      resizeCanvas(windowWidth, windowHeight);
    }
  </script>
</body>
</html>
